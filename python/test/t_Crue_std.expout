#!/usr/bin/env python
# coding: utf-8

from __future__ import print_function
import openturns as ot
import otguibase

myStudy = otguibase.OTStudy('myStudy')
otguibase.OTStudy.Add(myStudy)
dist_Q = ot.Gumbel(0.00179211, 1013)
dist_Q = ot.TruncatedDistribution(dist_Q, 0)
Q = otguibase.Input('Q', 0, 'Q (m3/s)', dist_Q)
dist_Ks = ot.Normal(30, 7.5)
dist_Ks = ot.TruncatedDistribution(dist_Ks, 0)
Ks = otguibase.Input('Ks', 0, 'Ks (m^(1/3)/s)', dist_Ks)
dist_Zv = ot.Uniform(49, 51)
Zv = otguibase.Input('Zv', 0, 'Zv (m)', dist_Zv)
dist_Zm = ot.Uniform(54, 56)
Zm = otguibase.Input('Zm', 0, 'Zm (m)', dist_Zm)
S = otguibase.Output('S', 0, '')
inputs = [Q, Ks, Zv, Zm]
outputs = [S]
formulas = ['(Q/(Ks*300.*sqrt((Zm-Zv)/5000)))^(3.0/5.0)+Zv-55.5-3.']
myPhysicalModel = otguibase.AnalyticalPhysicalModel('myPhysicalModel', inputs, outputs, formulas)
myStudy.add(myPhysicalModel)
limitState1 = otguibase.LimitState('limitState1', myPhysicalModel, 'S', ot.Greater(), 0)
myStudy.add(limitState1)
myMonteCarlo = otguibase.MonteCarloReliabilityAnalysis('myMonteCarlo', limitState1)
myMonteCarlo.setMaximumCalls(10000)
myMonteCarlo.setMaximumCoefficientOfVariation(0.01)
myMonteCarlo.setMaximumElapsedTime(60)
myMonteCarlo.setBlockSize(1)
myMonteCarlo.setSeed(0)
myStudy.add(myMonteCarlo)
myformIS = otguibase.FORMImportanceSamplingAnalysis('myformIS', limitState1)
myformIS.setMaximumCalls(10000)
myformIS.setMaximumCoefficientOfVariation(0.01)
myformIS.setMaximumElapsedTime(60)
myformIS.setBlockSize(1000)
myformIS.setSeed(0)
myformIS.setStandardSpaceDesignPoint([1.52607,-2.79207,0.697904,-0.306399])
myformIS.setPhysicalStartingPoint([1338.13,30.001,50,55])
myformIS.setStandardSpaceDesignPoint([1.52607,-2.79207,0.697904,-0.306399])
optimizationAlgo = ot.Cobyla()
optimizationAlgo.setMaximumIterationNumber(100)
optimizationAlgo.setMaximumAbsoluteError(1e-05)
optimizationAlgo.setMaximumRelativeError(1e-05)
optimizationAlgo.setMaximumResidualError(1e-05)
optimizationAlgo.setMaximumConstraintError(1e-05)
myformIS.setOptimizationAlgorithm(optimizationAlgo)
myStudy.add(myformIS)

